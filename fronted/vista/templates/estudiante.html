<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel del Estudiante</title>
    <link rel="stylesheet" href="../../../global/css/estudiante.css">
</head>
<body>

<div id="header"></div>

<div class="container">
    <h1 id="tituloBienvenida">Bienvenido, Estudiante</h1>

    <!-- PERFIL DEL ESTUDIANTE -->
    <section class="card">
        <h2>Perfil del Estudiante</h2>
        <p><strong>Nombre:</strong> <span id="nombreEst"></span></p>
        <p><strong>Carrera:</strong> <span id="carreraEst"></span></p>
        <p><strong>Email:</strong> <span id="emailEst"></span></p>
    </section>

    <!-- MATERIAS DEL ESTUDIANTE -->
    <section class="card">
        <h2>Materias Inscritas</h2>
        <ul id="listaMaterias"></ul>
    </section>

    <!-- HORARIO -->
    <section class="card">
        <h2>Horario Semanal</h2>
        <table class="tabla-horario">
            <thead>
                <tr>
                    <th>Día</th>
                    <th>Materia</th>
                    <th>Hora</th>
                </tr>
            </thead>
            <tbody id="tablaHorario"></tbody>
        </table>
        <button id="btnCerrarSesion">Cerrar sesión</button>

    </section>
   
</div>
<div id="footer"></div>

<script>
    // para cargar header y footer
    fetch("../../global/template/header.html")
        .then(r => r.text())
        .then(t => document.getElementById("header").innerHTML = t);

    fetch("../../global/template/footer.html")
        .then(r => r.text())
        .then(t => document.getElementById("footer").innerHTML = t);

    // Recuperar estudiante activo del login
    const estudiante = JSON.parse(sessionStorage.getItem("estudianteActivo"));

    // Si no hay estudiante logueado, volver al login
    if (!estudiante) {
        window.location.href = "index.html";
    }

    // TÍTULO DE BIENVENIDA
    document.getElementById("tituloBienvenida").textContent = "Hola, " + (estudiante.nombre || "") + " " + (estudiante.apellidos || "");

    // PERFIL
    document.getElementById("nombreEst").textContent = (estudiante.nombre || "") + " " + (estudiante.apellidos || "");
    document.getElementById("carreraEst").textContent = estudiante.carrera || "No registrada";
    document.getElementById("emailEst").textContent = estudiante.correo || "No registrado";

    // MATERIAS
    const listaMaterias = document.getElementById("listaMaterias");
    listaMaterias.innerHTML = "";
    if (!estudiante.materias || estudiante.materias.length === 0) {
        listaMaterias.innerHTML = "<li>No tiene materias registradas</li>";
    } else {
        estudiante.materias.forEach(m => {
            const li = document.createElement("li");
            li.textContent = m;
            listaMaterias.appendChild(li);
        });
    }

    // HORARIO
    const tablaHorario = document.getElementById("tablaHorario");
    tablaHorario.innerHTML = "";
    if (!estudiante.horario || estudiante.horario.length === 0) {
        tablaHorario.innerHTML = `<tr><td colspan="3">No tiene horario asignado</td></tr>`;
    } else {
        estudiante.horario.forEach(h => {
            const tr = document.createElement("tr");
            tr.innerHTML = `<td>${h.dia}</td><td>${h.materia}</td><td>${h.hora}</td>`;
            tablaHorario.appendChild(tr);
        });
    }

  // BOTÓN CERRAR SESIÓN
document.getElementById("btnCerrarSesion").addEventListener("click", () => {
    // Borrar el estudiante activo de la sesión
    sessionStorage.removeItem("estudianteActivo");
    

    // Redirigir al login principal
    window.location.href = "../../../index.html"; // Ajusta la ruta según la ubicación del login
});

</script>




</body>
</html>
